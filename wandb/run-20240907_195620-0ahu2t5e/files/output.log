

  2%|███                                                                                                                                                                                     | 1/60 [00:32<32:00, 32.55s/it]

  3%|██████▏                                                                                                                                                                                 | 2/60 [01:04<31:07, 32.20s/it]

  5%|█████████▏                                                                                                                                                                              | 3/60 [01:28<27:05, 28.52s/it]

  7%|████████████▎                                                                                                                                                                           | 4/60 [01:49<23:49, 25.52s/it]

  8%|███████████████▎                                                                                                                                                                        | 5/60 [02:10<21:47, 23.78s/it]

 10%|██████████████████▍                                                                                                                                                                     | 6/60 [02:30<20:25, 22.70s/it]

 12%|█████████████████████▍                                                                                                                                                                  | 7/60 [02:51<19:25, 21.98s/it]

 13%|████████████████████████▌                                                                                                                                                               | 8/60 [03:11<18:37, 21.49s/it]
{'loss': 2.5519, 'grad_norm': 4.356435775756836, 'learning_rate': 0.00019636363636363636, 'epoch': 0.02}


 17%|██████████████████████████████▌                                                                                                                                                        | 10/60 [03:52<17:20, 20.82s/it]

 18%|█████████████████████████████████▌                                                                                                                                                     | 11/60 [04:12<16:49, 20.60s/it]

 20%|████████████████████████████████████▌                                                                                                                                                  | 12/60 [04:32<16:19, 20.40s/it]
{'loss': 2.3244, 'grad_norm': 6.984297752380371, 'learning_rate': 0.00018181818181818183, 'epoch': 0.03}


 23%|██████████████████████████████████████████▋                                                                                                                                            | 14/60 [05:11<15:24, 20.10s/it]

 25%|█████████████████████████████████████████████▊                                                                                                                                         | 15/60 [05:31<14:59, 19.98s/it]

 27%|████████████████████████████████████████████████▊                                                                                                                                      | 16/60 [05:51<14:34, 19.87s/it]

 28%|███████████████████████████████████████████████████▊                                                                                                                                   | 17/60 [06:10<14:10, 19.78s/it]
{'loss': 1.8907, 'grad_norm': 10.66120719909668, 'learning_rate': 0.00016727272727272728, 'epoch': 0.04}


 32%|█████████████████████████████████████████████████████████▉                                                                                                                             | 19/60 [06:49<13:22, 19.58s/it]

 33%|█████████████████████████████████████████████████████████████                                                                                                                          | 20/60 [07:08<12:58, 19.46s/it]

 35%|████████████████████████████████████████████████████████████████                                                                                                                       | 21/60 [07:27<12:35, 19.36s/it]

 37%|███████████████████████████████████████████████████████████████████                                                                                                                    | 22/60 [07:51<13:04, 20.64s/it]

 38%|██████████████████████████████████████████████████████████████████████▏                                                                                                                | 23/60 [08:15<13:15, 21.49s/it]

 40%|█████████████████████████████████████████████████████████████████████████▏                                                                                                             | 24/60 [08:38<13:13, 22.03s/it]

 42%|████████████████████████████████████████████████████████████████████████████▎                                                                                                          | 25/60 [09:01<13:03, 22.38s/it]

 43%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 26/60 [09:24<12:48, 22.61s/it]

 45%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                    | 27/60 [09:47<12:31, 22.78s/it]

 47%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                                 | 28/60 [10:11<12:12, 22.89s/it]

 48%|████████████████████████████████████████████████████████████████████████████████████████▍                                                                                              | 29/60 [10:34<11:51, 22.95s/it]

 50%|███████████████████████████████████████████████████████████████████████████████████████████▌                                                                                           | 30/60 [10:57<11:29, 22.98s/it]

 52%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                        | 31/60 [11:20<11:05, 22.95s/it]
{'loss': 0.9251, 'grad_norm': 7.385511875152588, 'learning_rate': 0.00011636363636363636, 'epoch': 0.08}


 55%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                  | 33/60 [12:05<10:13, 22.73s/it]

 57%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 34/60 [12:27<09:47, 22.61s/it]

 58%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 35/60 [12:49<09:23, 22.53s/it]

 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                         | 36/60 [13:11<08:56, 22.36s/it]

 62%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                      | 37/60 [13:33<08:31, 22.24s/it]

 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 38/60 [13:55<08:07, 22.16s/it]

 65%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 39/60 [14:17<07:43, 22.06s/it]

 67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                             | 40/60 [14:39<07:19, 21.96s/it]

 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                          | 41/60 [14:53<06:12, 19.59s/it]
{'loss': 1.0827, 'grad_norm': 6.820347785949707, 'learning_rate': 8e-05, 'epoch': 0.1}


 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 43/60 [15:15<04:18, 15.21s/it]

 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                | 44/60 [15:26<03:42, 13.92s/it]

 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 45/60 [15:37<03:15, 13.02s/it]

 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 46/60 [15:47<02:52, 12.35s/it]

 78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 47/60 [15:58<02:34, 11.86s/it]

 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                    | 48/60 [16:09<02:17, 11.48s/it]

 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 49/60 [16:19<02:02, 11.16s/it]

 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 50/60 [16:29<01:46, 10.69s/it]

 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                           | 51/60 [17:02<02:36, 17.42s/it]

 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                        | 52/60 [17:35<02:56, 22.01s/it]

 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 53/60 [18:07<02:55, 25.01s/it]

 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 54/60 [18:31<02:28, 24.72s/it]

 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 55/60 [18:52<01:57, 23.59s/it]

 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊            | 56/60 [19:12<01:30, 22.74s/it]

 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊         | 57/60 [19:33<01:06, 22.11s/it]

 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 58/60 [19:53<00:43, 21.62s/it]

 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 59/60 [20:14<00:21, 21.27s/it]

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 60/60 [20:34<00:00, 21.01s/it]We detected that you are passing `past_key_values` as a tuple and this is deprecated and will be removed in v4.43. Please use an appropriate `Cache` class (https://huggingface.co/docs/transformers/v4.41.3/en/internal/generation_utils#transformers.Cache)
{'loss': 1.1931, 'grad_norm': 5.025282859802246, 'learning_rate': 1.0909090909090909e-05, 'epoch': 0.15}


























































































  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_LoRA.py", line 186, in <module>                                                | 91/535 [06:44<43:08,  5.83s/it]
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_LoRA.py", line 171, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2366, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2814, in _maybe_log_save_evaluate
    metrics = self._evaluate(trial, ignore_keys_for_eval)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2771, in _evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3676, in evaluate
    output = eval_loop(
             ^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3892, in evaluation_loop
    all_preds.add(logits)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer_pt_utils.py", line 322, in add
    self.tensors = nested_concat(self.tensors, tensors, padding_index=self.padding_index)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer_pt_utils.py", line 136, in nested_concat
    return torch_pad_and_concatenate(tensors, new_tensors, padding_index=padding_index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer_pt_utils.py", line 100, in torch_pad_and_concatenate
    result = tensor1.new_full(new_shape, padding_index)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 12.92 GiB. GPU 0 has a total capacity of 11.99 GiB of which 0 bytes is free. Of the allocated memory 27.88 GiB is allocated by PyTorch, and 1.74 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)