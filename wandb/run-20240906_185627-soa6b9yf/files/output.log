
  0%|                                                                                                                                                                                                               | 0/60 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  2%|███▎                                                                                                                                                                                                   | 1/60 [00:04<04:30,  4.59s/it]

  3%|██████▋                                                                                                                                                                                                | 2/60 [00:08<04:07,  4.26s/it]

  5%|██████████                                                                                                                                                                                               | 3/60 [00:12<03:59,  4.20s/it]

  7%|█████████████▍                                                                                                                                                                                           | 4/60 [00:17<04:00,  4.30s/it]

  8%|████████████████▊                                                                                                                                                                                        | 5/60 [00:21<03:54,  4.26s/it]

 10%|████████████████████                                                                                                                                                                                     | 6/60 [00:25<03:49,  4.25s/it]
{'loss': 3.439, 'grad_norm': 3.4210879802703857, 'learning_rate': 0.00019636363636363636, 'epoch': 0.0}


 13%|██████████████████████████▊                                                                                                                                                                              | 8/60 [00:34<03:42,  4.27s/it]

 15%|██████████████████████████████▏                                                                                                                                                                          | 9/60 [00:38<03:36,  4.25s/it]

 17%|█████████████████████████████████▎                                                                                                                                                                      | 10/60 [00:42<03:34,  4.29s/it]

 18%|████████████████████████████████████▋                                                                                                                                                                   | 11/60 [00:46<03:27,  4.24s/it]

 20%|████████████████████████████████████████                                                                                                                                                                | 12/60 [00:51<03:24,  4.25s/it]
{'loss': 1.1056, 'grad_norm': 6.077199935913086, 'learning_rate': 0.00017454545454545454, 'epoch': 0.01}


 23%|██████████████████████████████████████████████▋                                                                                                                                                         | 14/60 [01:00<03:26,  4.48s/it]

 25%|██████████████████████████████████████████████████                                                                                                                                                      | 15/60 [01:05<03:24,  4.55s/it]

 27%|█████████████████████████████████████████████████████▎                                                                                                                                                  | 16/60 [01:09<03:18,  4.50s/it]
{'loss': 0.4456, 'grad_norm': 0.9743152856826782, 'learning_rate': 0.00016, 'epoch': 0.01}


 30%|████████████████████████████████████████████████████████████                                                                                                                                            | 18/60 [01:18<03:07,  4.47s/it]

 32%|███████████████████████████████████████████████████████████████▎                                                                                                                                        | 19/60 [01:23<03:02,  4.46s/it]

 33%|██████████████████████████████████████████████████████████████████▋                                                                                                                                     | 20/60 [01:27<03:00,  4.51s/it]
{'loss': 0.3254, 'grad_norm': 0.6689308881759644, 'learning_rate': 0.00014545454545454546, 'epoch': 0.01}


 37%|█████████████████████████████████████████████████████████████████████████▎                                                                                                                              | 22/60 [01:36<02:48,  4.43s/it]

 38%|████████████████████████████████████████████████████████████████████████████▋                                                                                                                           | 23/60 [01:40<02:44,  4.44s/it]

 40%|████████████████████████████████████████████████████████████████████████████████                                                                                                                        | 24/60 [01:45<02:43,  4.54s/it]

 42%|███████████████████████████████████████████████████████████████████████████████████▎                                                                                                                    | 25/60 [01:49<02:35,  4.44s/it]

 43%|██████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                 | 26/60 [01:54<02:31,  4.44s/it]

 45%|██████████████████████████████████████████████████████████████████████████████████████████                                                                                                              | 27/60 [01:58<02:28,  4.50s/it]
{'loss': 0.0457, 'grad_norm': 1.1717294454574585, 'learning_rate': 0.00012, 'epoch': 0.01}


 48%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                       | 29/60 [02:08<02:28,  4.78s/it]

 50%|████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 30/60 [02:13<02:24,  4.81s/it]

 52%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 31/60 [02:18<02:18,  4.77s/it]

 53%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 32/60 [02:23<02:11,  4.71s/it]

 55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                          | 33/60 [02:27<02:05,  4.65s/it]

 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                      | 34/60 [02:32<02:01,  4.68s/it]

 58%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                   | 35/60 [02:37<01:59,  4.79s/it]

 60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                | 36/60 [02:42<01:57,  4.89s/it]

 62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                            | 37/60 [02:47<01:50,  4.80s/it]
{'loss': 0.0055, 'grad_norm': 0.36441710591316223, 'learning_rate': 8.363636363636364e-05, 'epoch': 0.02}


 65%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                      | 39/60 [02:56<01:38,  4.67s/it]

 67%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 40/60 [03:00<01:28,  4.42s/it]

 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                               | 41/60 [03:04<01:23,  4.39s/it]

 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 42/60 [03:09<01:20,  4.49s/it]

 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                        | 43/60 [03:13<01:13,  4.32s/it]

 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                     | 44/60 [03:16<01:06,  4.16s/it]

 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                  | 45/60 [03:20<00:59,  4.00s/it]
{'loss': 0.0018, 'grad_norm': 0.06986550986766815, 'learning_rate': 5.4545454545454546e-05, 'epoch': 0.02}


 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 47/60 [03:27<00:49,  3.81s/it]

 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                        | 48/60 [03:31<00:45,  3.77s/it]

 82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                    | 49/60 [03:35<00:40,  3.72s/it]

 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 50/60 [03:38<00:37,  3.71s/it]

 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 51/60 [03:42<00:33,  3.69s/it]
{'loss': 0.0011, 'grad_norm': 0.03868138790130615, 'learning_rate': 3.272727272727273e-05, 'epoch': 0.02}


 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                       | 53/60 [03:49<00:25,  3.67s/it]

 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 54/60 [03:53<00:21,  3.66s/it]

 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                | 55/60 [03:57<00:18,  3.66s/it]

 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋             | 56/60 [04:00<00:14,  3.66s/it]
{'loss': 0.0009, 'grad_norm': 0.03131173178553581, 'learning_rate': 1.4545454545454545e-05, 'epoch': 0.03}


 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 58/60 [04:07<00:07,  3.65s/it]

 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 59/60 [04:11<00:03,  3.65s/it]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 60/60 [04:15<00:00,  3.65s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 60/60 [04:16<00:00,  4.27s/it]
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
{'train_runtime': 258.8501, 'train_samples_per_second': 1.854, 'train_steps_per_second': 0.232, 'train_loss': 0.6879649035137845, 'epoch': 0.03}
<|begin_of_text|>### Type: information
 ### Question: What is (are) Parasites - Scabies?

 ### Answer:  Scabies.


### Type: Multiple Choice
























### Below is a question that describe a question. Write a response that appropriately answer the question. Write your response below the question. Write your response appropriately. Do not exceed the word limit described in the question.

### Correct response

### Below is
Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_LoRA.py", line 134, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_LoRA.py", line 130, in main
    output_tokens = model.generate(**input_tokens, streamer=streamer, max_new_tokens=100, do_sample=True, top_p=0.8)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\peft\peft_model.py", line 1638, in generate
    outputs = self.base_model.generate(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\generation\utils.py", line 2024, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\generation\utils.py", line 3020, in _sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt